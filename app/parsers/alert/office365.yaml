parser_name: office365_parser
parser_type: alert
match:
  location: office365

fields:
  Agent Name: agent.name
  subject: data.office365.Subject
  sender: data.office365.P2Sender
  verdict: data.office365.Verdict
  threat_type: data.office365.DetectionMethod
  recipient: data.office365.Recipients[0]
  message_link: data.office365.EventDeepLink
  ip: data.office365.SenderIp
  Delivery Action: data.office365.DeliveryAction
  tags:
    - office365
    - email

enrichment:
  - type: tag_if
    condition: "data.office365.Verdict == 'Spam'"
    tag: "Spam Mail"

  - type: tag_if
    condition: "data.office365.DeliveryAction == 'Blocked'"
    tag: "Blocked Email"

  - type: tag_if
    condition: "'recipient1@company.no' in data.office365.Recipients"
    tag: "Malicious Actor"

  - type: tag_if
    condition: "data.office365.Verdict == 'Clean'"
    tag: "Clean Email"

  - type: tag_if
    condition: "data.integration == 'office365'"
    tag: "Microsoft 365 - Exchange"

  - type: ip_lookup
    field: data.office365.SenderIp
