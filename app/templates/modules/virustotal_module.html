{% extends "_design.html" %}
{% block title %}VirusTotal Configuration - Sentinel Commander{% endblock %}

{% block content %}
<div class="container my-4">

  <div class="card bg-dark border border-secondary shadow-sm">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">🦠 VirusTotal Module Configuration</h5>
      <a href="/web/v1/settings/modules" class="btn btn-sm btn-outline-secondary">
        ← Back to Settings
      </a>
    </div>

    <div class="card-body">

      {% if is_configured %}
        <div class="alert alert-success">✅ VirusTotal Module is Configured!</div>
      {% else %}
        <div class="alert alert-warning">⚠️ VirusTotal Module is not fully configured.</div>
      {% endif %}

      <form method="post" action="/web/v1/modules/create">
        <h6 class="mb-2">🔗 VirusTotal API Settings</h6>
        <div class="mb-3">
          <label class="form-label">VirusTotal API URL</label>
          <input type="url" name="remote_url" class="form-control"
                 placeholder="https://www.virustotal.com/api/v3"
                 value="{{ vt_entry.remote_url if vt_entry else '' }}" required>
        </div>
        <div class="mb-3">
          <label class="form-label">VirusTotal API Key</label>
          <input type="text" name="remote_api_key" class="form-control"
                 placeholder="Paste your API Key"
                 value="{{ vt_entry.remote_api_key if vt_entry else '' }}" required>
        </div>
        <input type="hidden" name="name" value="VirusTotal">
        <input type="hidden" name="is_local" value="false">
        <button type="submit" class="btn btn-success">💾 Save & Populate</button>
      </form>

    </div>
  </div>

</div>
{% endblock %}
