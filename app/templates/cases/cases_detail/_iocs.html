<div class="tab-pane fade" id="iocs" role="tabpanel">
  <h5 class="mt-3">ðŸ§¬ Indicators of Compromise (IOCs)</h5>

  <!-- Add New IOC -->
  <form method="post" action="/web/v1/cases/{{ case.id }}/iocs" class="mb-4">
    <div class="row g-2">
      <div class="col-md-2">
        <input type="text" name="type" class="form-control" placeholder="Type (e.g. ip)" required>
      </div>
      <div class="col-md-3">
        <input type="text" name="value" class="form-control" placeholder="Value" required>
      </div>
      <div class="col-md-3">
        <input type="text" name="source" class="form-control" placeholder="Source (optional)">
      </div>
      <div class="col-md-2">
        <input type="text" name="tags" class="form-control" placeholder="Tags (comma-separated)">
      </div>
      <div class="col-md-10 mt-2">
        <textarea name="description" class="form-control" placeholder="Description (optional)"></textarea>
      </div>
      <div class="col-md-2 mt-2">
        <button type="submit" class="btn btn-primary w-100">Add IOC</button>
      </div>
    </div>
  </form>

  <!-- Existing IOCs -->
  {% if iocs %}
    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle">
        <thead>
          <tr>
            <th>Type</th>
            <th>Value</th>
            <th>Source</th>
            <th>Tags</th>
            <th>Description</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for ioc in iocs %}
          <tr>
            <td>{{ ioc.type }}</td>
            <td>{{ ioc.value }}</td>
            <td>{{ ioc.source or 'â€”' }}</td>
            <td>{{ ioc.tags or 'â€”' }}</td>
            <td>{{ ioc.description or 'â€”' }}</td>
            <td>
              <!-- Edit Toggle -->
              <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#editIOC{{ ioc.id }}">Edit</button>

              <!-- Delete Form -->
              <form method="post" action="/web/v1/cases/{{ case.id }}/iocs/{{ ioc.id }}/delete" class="d-inline">
                <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Delete this IOC?')">Delete</button>
              </form>
            </td>
          </tr>
          <!-- Edit Form -->
          <tr class="collapse" id="editIOC{{ ioc.id }}">
            <td colspan="6">
              <form method="post" action="/web/v1/cases/{{ case.id }}/iocs/{{ ioc.id }}/edit">
                <div class="row g-2">
                  <div class="col-md-2">
                    <input type="text" name="type" class="form-control" value="{{ ioc.type }}" required>
                  </div>
                  <div class="col-md-3">
                    <input type="text" name="value" class="form-control" value="{{ ioc.value }}" required>
                  </div>
                  <div class="col-md-3">
                    <input type="text" name="source" class="form-control" value="{{ ioc.source }}">
                  </div>
                  <div class="col-md-2">
                    <input type="text" name="tags" class="form-control" value="{{ ioc.tags }}">
                  </div>
                  <div class="col-md-10 mt-2">
                    <textarea name="description" class="form-control">{{ ioc.description }}</textarea>
                  </div>
                  <div class="col-md-2 mt-2">
                    <button type="submit" class="btn btn-success w-100">Save</button>
                  </div>
                </div>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="text-muted">No IOCs added yet.</p>
  {% endif %}
</div>
